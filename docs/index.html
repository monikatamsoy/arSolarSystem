<!DOCTYPE html>
<html>

<head>
    <title>Planets and moons</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"
        integrity="sha512-dLxUelApnYxpLt6K2iomGngnHO83iUvZytA3YjDUCjT0HDOHKXnVYdf3hU4JjM8uEhxf9nD1/ey98U3t2vZ0qQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <div id="webgl"></div>
    <script src="js/dat.gui.min.js"></script>
    <!-- <script src="js/three.js"></script> -->

    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.min.js" integrity="sha512-n8IpKWzDnBOcBhRlHirMZOUvEq2bLRMuJGjuVqbzUJwtTsgwOgK5aS0c1JA647XWYfqvXve8k3PtZdzpipFjgg==" crossorigin="anonymous"></script> -->
    <script src="js/OrbitControls.js"></script>
    <script type="module">
        import { LoadingBar } from "./libs/LoadingBar.js";
      // document.addEventListener("DOMContentLoaded", function(){
      // window.app = app;
      // });
    </script>
    
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <!-- <script type = 'module' >
            import {ARButton} from "./libs/ARButton.js";
            
        </script> -->

    <script type="module">
        import { ARButton } from "https://unpkg.com/three/examples/jsm/webxr/ARButton.js";
        let camera, scene, renderer, controls;
      
      function update(renderer, scene, camera, controls) {
        // pointLight.position.copy(sun.position);
        controls.update();

        var time = Date.now();
        // t += 0.5;
        // earth.position.x = earthData.distanceFromAxis*Math.cos(t)
        
        renderer.render(scene, camera);
        // requestAnimationFrame(this.animate.bind(this));
        requestAnimationFrame(function () {
          update(renderer, scene, camera, controls);
        });
      }

      

      
      function init() {
        // Create the camera that allows us to view into the scene.
        camera = new THREE.PerspectiveCamera(
          45, // field of view
          window.innerWidth / window.innerHeight, // aspect ratio
          1, // near clipping plane
          1000 // far clipping plane
        );
        camera.position.z = 1;
        camera.position.x = 0;
        camera.position.y = 0;

        
        scene = new THREE.Scene();

        // Create the renderer that controls animation.
        renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.xr.enabled = true;
        // renderer.xr.setReferenceSpaceType( 'local' );

        // Attach the renderer to the div element.
        document.getElementById("webgl").appendChild(renderer.domElement);

        // Create controls that allows a user to move the scene with a mouse.
        controls = new THREE.OrbitControls(camera, renderer.domElement);

        const button = ARButton.createButton(renderer);

        document.body.appendChild(button);
        
        var ambientLight = new THREE.AmbientLight(0xaaaaaa);
        // scene.add(ambientLight);
        const geometry = new THREE.BoxGeometry( 1, 1, 1 );
        const texture = new THREE.TextureLoader().load( 'cubemap/nx.jpeg' );

// immediately use the texture for material creation
const material = new THREE.MeshBasicMaterial( { map: texture } );
        
        const cube = new THREE.Mesh( geometry, material );
        scene.add( cube );    

        
        // Start the animation.
        update(renderer, scene, camera, controls);

        // window.addEventListener("resize", onWindowResize, false);
        // document.addEventListener("keydown", onKeyDown, false);

        function onWindowResize() {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();

          renderer.setSize(window.innerWidth, window.innerHeight);
        }
      }

      // Start everything.
      init();
    </script>
</body>

</html>